<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:SportowyHub.ViewModels"
             xmlns:res="clr-namespace:SportowyHub.Resources.Strings"
             x:Class="SportowyHub.Views.Auth.LoginPage"
             x:DataType="vm:LoginViewModel"
             Title="{x:Static res:AppResources.AuthSignIn}"
             Shell.TabBarIsVisible="False">

    <ScrollView>
        <VerticalStackLayout Padding="24" Spacing="8">

            <Label AutomationId="LoginHeadline"
                   Text="{x:Static res:AppResources.AuthSignIn}"
                   Style="{StaticResource Headline}"
                   HorizontalOptions="Start"
                   Margin="0,16,0,24" />

            <!-- Email Field -->
            <Label Text="{x:Static res:AppResources.AuthEmail}" Style="{StaticResource FieldLabel}" />
            <Border BackgroundColor="{AppThemeBinding Light={StaticResource Surface}, Dark={StaticResource SurfaceDark}}"
                    StrokeThickness="1"
                    Stroke="{AppThemeBinding Light={StaticResource Border}, Dark={StaticResource BorderDark}}"
                    Padding="12,0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="12" />
                </Border.StrokeShape>
                <Entry AutomationId="LoginEmailEntry"
                       Text="{Binding Email}"
                       Placeholder="{x:Static res:AppResources.AuthEnterEmail}"
                       Keyboard="Email"
                       BackgroundColor="Transparent" />
            </Border>
            <Label Text="{Binding EmailError}"
                   Style="{StaticResource ErrorLabel}"
                   IsVisible="{Binding EmailError.Length, Converter={StaticResource IntToBoolConverter}}" />

            <!-- Password Field -->
            <Label Text="{x:Static res:AppResources.AuthPassword}" Style="{StaticResource FieldLabel}" Margin="0,8,0,4" />
            <Border BackgroundColor="{AppThemeBinding Light={StaticResource Surface}, Dark={StaticResource SurfaceDark}}"
                    StrokeThickness="1"
                    Stroke="{AppThemeBinding Light={StaticResource Border}, Dark={StaticResource BorderDark}}"
                    Padding="12,0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="12" />
                </Border.StrokeShape>
                <Grid ColumnDefinitions="*,Auto">
                    <Entry Grid.Column="0"
                           AutomationId="LoginPasswordEntry"
                           Text="{Binding Password}"
                           Placeholder="{x:Static res:AppResources.AuthEnterPassword}"
                           IsPassword="{Binding IsPasswordVisible, Converter={StaticResource InvertBoolConverter}}"
                           BackgroundColor="Transparent" />
                    <ImageButton Grid.Column="1"
                                 Source="{Binding IsPasswordVisible, Converter={StaticResource BoolToEyeIconConverter}}"
                                 Command="{Binding TogglePasswordVisibilityCommand}"
                                 HeightRequest="24"
                                 WidthRequest="24"
                                 BackgroundColor="Transparent"
                                 VerticalOptions="Center"
                                 Margin="8,0" />
                </Grid>
            </Border>

            <!-- Forgot Password -->
            <Label Text="{x:Static res:AppResources.AuthForgotPassword}"
                   TextColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource PrimaryDark}}"
                   FontSize="13"
                   HorizontalOptions="End"
                   Margin="0,8,0,0" />

            <!-- Login Error -->
            <Label Text="{Binding LoginError}"
                   Style="{StaticResource ErrorLabel}"
                   IsVisible="{Binding LoginError.Length, Converter={StaticResource IntToBoolConverter}}"
                   Margin="0,16,0,0" />

            <!-- Loading Indicator -->
            <ActivityIndicator IsRunning="{Binding IsLoading}"
                               IsVisible="{Binding IsLoading}"
                               Color="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource PrimaryDark}}"
                               Margin="0,8,0,0" />

            <!-- Login Button -->
            <Button Text="{x:Static res:AppResources.AuthLogin}"
                    Style="{StaticResource PrimaryButton}"
                    Command="{Binding LoginCommand}"
                    IsEnabled="{Binding IsLoading, Converter={StaticResource InvertBoolConverter}}"
                    HorizontalOptions="Fill"
                    Margin="0,8,0,0" />

            <!-- Create Account Link -->
            <HorizontalStackLayout HorizontalOptions="Center" Spacing="4" Margin="0,16,0,0">
                <Label Text="{x:Static res:AppResources.AuthNoAccount}"
                       TextColor="{AppThemeBinding Light={StaticResource TextSecondary}, Dark={StaticResource TextSecondaryDark}}"
                       FontSize="13"
                       VerticalOptions="Center" />
                <Label Text="{x:Static res:AppResources.AuthCreateAccount}"
                       TextColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource PrimaryDark}}"
                       FontSize="13"
                       FontFamily="OpenSansSemibold"
                       VerticalOptions="Center">
                    <Label.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding NavigateToRegisterCommand}" />
                    </Label.GestureRecognizers>
                </Label>
            </HorizontalStackLayout>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
